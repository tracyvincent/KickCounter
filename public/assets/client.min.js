var app=angular.module("kickApp",["ngRoute"]);app.filter("secondsToTime",function(){function a(a){return a<10?"0"+a:a}return function(b){if("number"!=typeof b||b<0)return"00:00:00";var c=Math.floor(b/3600),d=Math.floor(b%3600/60),e=Math.floor(b%60);return a(c)+":"+a(d)+":"+a(e)}}),angular.module("kickApp").config(["$routeProvider","$locationProvider",function(a,b){a.when("/",{templateUrl:"/views/login.html",controller:"LoginController",controllerAs:"login"}).when("/register",{templateUrl:"/views/register.html",controller:"RegisterController",controllerAs:"register"}).when("/dashboard",{templateUrl:"views/dashboard.html",controller:"DashboardController",controllerAs:"dash"}).when("/game",{templateUrl:"views/game.html",controller:"GameController",controllerAs:"game"}).when("/continueGame",{templateUrl:"views/continueGame.html",controller:"ContinueController",controllerAs:"continue"}).when("/kickReport",{templateUrl:"views/kickReport.html",controller:"ReportController",controllerAs:"report"}),b.html5Mode(!0)}]),app.controller("MainController",["$http",function(a){}]),app.controller("LoginController",["$http","$location",function(a,b){function c(a){b.path("/dashboard")}function d(a){}var e=this;e.username="",e.password="",e.login=function(){var b={};b.username=e.username,b.password=e.password,a.post("/login",b).then(c,d)}}]),app.controller("RegisterController",["$http","$location",function(a,b){var c=this;c.show=!1,c.username="",c.password="",c.password2="",c.register=function(){function d(a){b.path("/")}function e(a){b.path("/")}if(c.password!=c.password2)return void(c.show=!0);var f={};f.username=c.username,f.password=c.password,a.post("/register",f).then(d,e)}}]),app.controller("DashboardController",["$http","$location","DataService",function(a,b,c){var d=this;d.untimedGames=[],d.timedGames={},c.loadTimed(),untimedSuccess=function(a){d.untimedGames=a.data.reverse()},untimedFail=function(a){console.log("untimed load fail",a)},d.loadUntimed=function(){a.get("/dashboard/untimed").then(untimedSuccess,untimedFail)},d.loadUntimed(),timedSuccess=function(a){d.timedGames=a.data.reverse()},timedFail=function(a){console.log("timed load fail",a)},d.loadTimed=function(){a.get("/dashboard/timed").then(timedSuccess,timedFail)},d.loadTimed(),deleteUntimedFail=function(a){console.log("delete untimed fail")},d.deleteUntimedGame=function(b,c){a.delete("/dashboard/deleteUntimed/"+b).then(function(a){d.untimedGames.splice(c,1),console.log("delete untimed success")},deleteUntimedFail)},deleteTimedFail=function(a){console.log("delete timed fail")},d.deleteTimedGame=function(b,c){a.delete("/dashboard/deleteTimed/"+b).then(function(a){d.timedGames.splice(c,1)},deleteTimedFail)},d.continueGame=function(a){c.setContinueGame(a)}}]),app.controller("GameController",["$http","$location","$interval",function(a,b,c,d){function e(){f.seconds++}var f=this;f.gameInit=function(){f.timer=null,f.timeDisplay=!1,f.gameSettings={},f.gameForm=!0,f.gameTitle=!1,f.gameData={},f.gameData.totalScore=0,f.gameData.winner={name:"",score:0},f.saveGameSet=!1,f.seconds=0,f.timeButtons=!1,f.gameStart=null,f.startNew=!1,f.players=[],f.scoreButton=!1,f.playerInput=!0,f.playerTitle=!1},f.gameInit(),f.start=function(){f.saveGameSet=!1,f.scoreButton=!0,f.timer||(f.timer=c(e,1e3)),null==f.gameStart&&(f.gameStart=new Date)},f.stop=function(){f.saveGameSet=!0,f.scoreButton=!1,f.timer&&(c.cancel(f.timer),f.timer=null)},f.activatePlayers=function(a){for(var b=1,c=1;c<=a;c++)f.players.push({name:"Name Player"+b,score:0}),b++},f.saveGameSettings=function(){f.gameForm=!1,f.gameTitle=!0,f.activatePlayers(f.gameSettings.numPlayers),"false"==f.gameSettings.timed?(f.saveGameSet=!0,f.scoreButton=!0,f.gameStart=new Date):(f.timeDisplay=!0,f.timeButtons=!0)},f.startNewGame=function(){f.gameInit()},f.scorePoint=function(a){f.players[a].score++},handleSuccess=function(){console.log("game saved")},handleFailure=function(){console.log("failed saving game")},f.saveGameData=function(){for(var b=0;b<f.players.length;b++)f.gameData.totalScore+=f.players[b].score;for(var b=0;b<f.players.length;b++)f.players[b].score>f.gameData.winner.score?f.gameData.winner=angular.copy(f.players[b]):f.players[b].score==f.gameData.winner.score&&(f.gameData.winner.name+=" and "+f.players[b].name+" each ");f.gameData.gameDuration=f.seconds,f.gameData.gameName=f.gameSettings.name,f.gameData.gameStart=f.gameStart,f.gameData.players=f.players,f.saveGameSet=!1,f.timeButtons=!1,f.scoreButton=!1,f.playerTitle=!0,f.playerInput=!1,a.post("/game",f.gameData).then(handleSuccess,handleFailure),f.startNew=!0},f.deleteGame=function(){f.gameInit()}}]),app.controller("ContinueController",["$http","$location","DataService",function(a,b,c){var d=this;d.gameSettings={},d.scoreButton=!0,d.pageLoad=function(){d.gameSettings=c.getDataServiceGame()},d.scorePoint=function(a){d.gameSettings.totalScore++,d.gameSettings.players[a].score++},d.handleSuccess=function(a){console.log("saved successfullly",a)},d.handleFailure=function(a){console.log("save fail",a)},d.saveGameUpdates=function(){d.scoreButton=!1,d.gameSettings.winner={name:"",score:0};for(var b=0;b<d.gameSettings.players.length;b++)d.gameSettings.players[b].score>d.gameSettings.winner.score?d.gameSettings.winner=angular.copy(d.gameSettings.players[b]):d.gameSettings.players[b].score==d.gameSettings.winner.score&&(d.gameSettings.winner.name+=" and "+d.gameSettings.players[b].name+" each ");a.put("/update/"+d.gameSettings._id,d.gameSettings).then(d.handleSuccess,d.handleFailure)}}]),app.factory("DataService",["$http",function(a){function b(a){c=a}var c={},d={};return timedSuccess=function(a){console.log("timed load success",a),d=a.data},timedFail=function(a){console.log("timed load fail",a)},loadTimed=function(){a.get("/dashboard/timed").then(timedSuccess,timedFail)},{getDataServiceGame:function(){return c},setContinueGame:b,loadTimed:loadTimed,getTimedGames:function(){return d}}}]),app.controller("ReportController",["$http","DataService",function(a,b){var c=this;c.timedGames={},c.print=function(){window.print()},timedSuccess=function(a){c.timedGames=a.data},timedFail=function(a){console.log("timed load fail",a)},c.loadTimed=function(){a.get("/dashboard/timed").then(timedSuccess,timedFail)},c.loadTimed()}]);